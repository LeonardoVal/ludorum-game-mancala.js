//! ludorum-game-mancala 0.1.1

(function(t){"use strict";this["ludorum-game-mancala"]=t(this.base,this.Sermat,this.ludorum)}).call(this,function t(r,e,s){"use strict";var a=r.declare,n=(r.raise,r.raiseIf),i=r.Iterable,o=r.iterable,u=s.Game,h=(s.players.UserInterface,{__package__:"ludorum-game-mancala",__name__:"ludorum_game_mancala",__init__:t,__dependencies__:[r,e,s],__SERMAT__:{include:[r,s]}}),c=h.Mancala=a(u,{name:"Mancala",constructor:function(t,r){u.call(this,t),this.board=r||this.makeBoard()},"dual makeBoard":function(t,r){t=isNaN(t)?4:+t,r=isNaN(r)?6:+r;for(var e=[],s=0;s<2;s++){for(var a=0;a<r;a++)e.push(t);e.push(0)}return e},players:["North","South"],emptyCapture:!1,countRemainingSeeds:!0,store:function(t){switch(this.players.indexOf(t)){case 0:return this.board.length/2-1;case 1:return this.board.length-1;default:throw new Error("Invalid player "+t+".")}},houses:function(t){switch(this.players.indexOf(t)){case 0:return i.range(0,this.board.length/2-1).toArray();case 1:return i.range(this.board.length/2,this.board.length-1).toArray();default:throw new Error("Invalid player "+t+".")}},oppositeHouse:function(t,r){var e=this.houses(t),s=this.houses(this.opponent(t)),a=e.indexOf(r);return a<0?a:s.reverse()[a]},nextSquare:function(t,r){do{r=(r+1)%this.board.length}while(r===this.store(this.opponent(t)));return r},moves:function(){if(this.result())return null;var t=this.board,r={},e=this.activePlayer();return r[e]=this.houses(e).filter(function(r){return t[r]>0}),r[e].length>0?r:null},scores:function(){var t=this,r=this.board,e=this.players.map(function(e){return o(t.houses(e)).map(function(t){return r[t]}).sum()});if(e[0]>0&&e[1]>0)return null;var s={};return this.players.forEach(function(a,n){s[a]=r[t.store(a)]+t.countRemainingSeeds*e[n]}),s},result:function(){var t=this.scores(),r=this.players;return t&&this.zerosumResult(t[r[0]]-t[r[1]],r[0])},next:function(t,r,e){n(r,"Haps are not required (given ",r,")!");var s,a,i,o=this.activePlayer(),u=+t[o],h=this.board.slice(0),c=h[u];for(n(c<1,"Invalid move ",u," for game ",this),h[u]=0;c>0;c--)h[u=this.nextSquare(o,u)]++;(s=u==this.store(o))||(i=this.oppositeHouse(o,u))>=0&&1==h[u]&&h[i]>0&&(h[a=this.store(o)]++,h[u]=0,this.emptyCapture||(h[a]+=h[i],h[i]=0));var l=s?o:this.opponent();return e?(this.activatePlayers(l),this.board=h,this):new this.constructor(l,h)},resultBounds:function(){var t=o(this.board).sum();return[-t,+t]},"static __SERMAT__":{identifier:h.__package__+".Mancala",serializer:function(t){return[t.activePlayer(),t.board]}},identifier:function(){return this.activePlayer().charAt(0)+this.board.map(function(t){return("00"+t.toString(36)).substr(-2)}).join("")},printBoard:function(){var t=this,e=r.Text.lpad,s=this.players[0],a=this.houses(s).map(function(r){return e(""+t.board[r],2,"0")}).reverse(),n=e(""+this.board[this.store(s)],2,"0"),i=this.players[1],o=this.houses(i).map(function(r){return e(""+t.board[r],2,"0")}),u=e(""+this.board[this.store(i)],2,"0");return"   "+a.join(" | ")+"   \n"+n+" ".repeat(2*a.length+3*(a.length-1)+2)+u+"\n   "+o.join(" | ")+"   "}});return s.games.Mancala=c,h.__SERMAT__.include.push(c),e.include(h),c.heuristics={fromWeights:function(t){var r=o(t).map(Math.abs).sum();function e(e,s){var a,n=0;switch(e.players.indexOf(s)){case 0:a=1;break;case 1:a=-1;break;default:throw new Error("Invalid player "+s+".")}return o(e.board).map(function(r,e){return n+=r,r*t[e]}).sum()/r/n*a}return e.weights=t,e}},c.heuristics.DEFAULT=c.heuristics.fromWeights([1,1,1,1,1,1,5,-1,-1,-1,-1,-1,-1,-5]),h});
//# sourceMappingURL=ludorum-game-mancala-tag.min.js.map