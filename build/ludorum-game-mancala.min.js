//! ludorum-game-mancala 0.1.0

(function(a){"use strict";"function"==typeof define&&define.amd?define(["creatartis-base","sermat","ludorum"],a):"object"==typeof exports&&module.exports?module.exports=a(require("creatartis-base"),require("sermat"),require("ludorum")):this.Sermat=a(this.base,this.Sermat,this.ludorum)}).call(this,function a(b,c,d){"use strict";var e=b.declare,f=(b.raise,b.raiseIf),g=b.Iterable,h=b.iterable,i=d.Game,j=(d.players.UserInterface,{__package__:"ludorum-game-mancala",__name__:"ludorum_game_mancala",__init__:a,__dependencies__:[b,c,d],__SERMAT__:{include:[b,d]}}),k=j.Mancala=e(i,{name:"Mancala",constructor:function(a,b){i.call(this,a),this.board=b||this.makeBoard()},makeBoard:function(a,b){a=isNaN(a)?4:+a,b=isNaN(b)?6:+b;for(var c=[],d=0;d<2;d++){for(var e=0;e<b;e++)c.push(a);c.push(0)}return c},players:["North","South"],emptyCapture:!1,countRemainingSeeds:!0,store:function(a){switch(this.players.indexOf(a)){case 0:return this.board.length/2-1;case 1:return this.board.length-1;default:throw new Error("Invalid player "+a+".")}},houses:function(a){switch(this.players.indexOf(a)){case 0:return g.range(0,this.board.length/2-1).toArray();case 1:return g.range(this.board.length/2,this.board.length-1).toArray();default:throw new Error("Invalid player "+a+".")}},oppositeHouse:function(a,b){var c=this.houses(a),d=this.houses(this.opponent(a)),e=c.indexOf(b);return e<0?e:d.reverse()[e]},nextSquare:function(a,b){do b=(b+1)%this.board.length;while(b===this.store(this.opponent(a)));return b},moves:function(){if(this.result())return null;var a=this.board,b={},c=this.activePlayer();return b[c]=this.houses(c).filter(function(b){return a[b]>0}),b[c].length>0?b:null},scores:function(){var a=this,b=this.board,c=this.players.map(function(c){return h(a.houses(c)).map(function(a){return b[a]}).sum()});if(c[0]>0&&c[1]>0)return null;var d={};return this.players.forEach(function(e,f){d[e]=b[a.store(e)]+a.countRemainingSeeds*c[f]}),d},result:function(){var a=this.scores(),b=this.players;return a&&this.zerosumResult(a[b[0]]-a[b[1]],b[0])},next:function(a,b,c){f(b,"Haps are not required (given ",b,")!");var d,e,g=this.activePlayer(),h=+a[g],i=this.board.slice(0),j=i[h],k=!1;for(f(j<1,"Invalid move ",h," for game ",this),i[h]=0;j>0;j--)h=this.nextSquare(g,h),i[h]++;k=h==this.store(g),k||(e=this.oppositeHouse(g,h),e>=0&&1==i[h]&&i[e]>0&&(d=this.store(g),i[d]++,i[h]=0,this.emptyCapture||(i[d]+=i[e],i[e]=0)));var l=k?g:this.opponent();return c?(this.activatePlayers(l),this.board=i,this):new this.constructor(l,i)},resultBounds:function(){var a=h(this.board).sum();return[-a,+a]},"static __SERMAT__":{identifier:j.__package__+".Mancala",serializer:function(a){return[a.activePlayer(),a.board]}},identifier:function(){return this.activePlayer().charAt(0)+this.board.map(function(a){return("00"+a.toString(36)).substr(-2)}).join("")},printBoard:function(){var a=this,c=b.Text.lpad,d=this.players[0],e=this.houses(d).map(function(b){return c(""+a.board[b],2,"0")}).reverse(),f=c(""+this.board[this.store(d)],2,"0"),g=this.players[1],h=this.houses(g).map(function(b){return c(""+a.board[b],2,"0")}),i=c(""+this.board[this.store(g)],2,"0");return"   "+e.join(" | ")+"   \n"+f+" ".repeat(2*e.length+3*(e.length-1)+2)+i+"\n   "+h.join(" | ")+"   "}});return k.makeBoard=k.prototype.makeBoard,d.games.Mancala=k,j.__SERMAT__.include.push(k),c.include(j),k.heuristics={fromWeights:function(a){function b(b,d){var e,f,g=0;switch(b.players.indexOf(d)){case 0:e=1;break;case 1:e=-1;break;default:throw new Error("Invalid player "+d+".")}return f=h(b.board).map(function(b,c){return g+=b,b*a[c]}).sum()/c/g*e}var c=h(a).map(Math.abs).sum();return b.weights=a,b}},k.heuristics.DEFAULT=k.heuristics.fromWeights([1,1,1,1,1,1,5,-1,-1,-1,-1,-1,-1,-5]),j});
//# sourceMappingURL=ludorum-game-mancala.min.js.map