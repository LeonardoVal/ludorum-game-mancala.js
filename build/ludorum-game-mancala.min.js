//! ludorum-game-mancala 0.1.1

(function(e){"use strict";"function"==typeof define&&define.amd?define(["creatartis-base","sermat","ludorum"],e):"object"==typeof exports&&module.exports?module.exports=e(require("creatartis-base"),require("sermat"),require("ludorum")):this["ludorum-game-mancala"]=e(this.base,this.Sermat,this.ludorum)}).call(this,function e(t,r,s){"use strict";var a=t.declare,i=(t.raise,t.raiseIf),n=t.Iterable,o=t.iterable,u=s.Game,h=(s.players.UserInterface,{__package__:"ludorum-game-mancala",__name__:"ludorum_game_mancala",__init__:e,__dependencies__:[t,r,s],__SERMAT__:{include:[t,s]}}),c=h.Mancala=a(u,{name:"Mancala",constructor:function(e,t){u.call(this,e),this.board=t||this.makeBoard()},"dual makeBoard":function(e,t){e=isNaN(e)?4:+e,t=isNaN(t)?6:+t;for(var r=[],s=0;s<2;s++){for(var a=0;a<t;a++)r.push(e);r.push(0)}return r},players:["North","South"],emptyCapture:!1,countRemainingSeeds:!0,store:function(e){switch(this.players.indexOf(e)){case 0:return this.board.length/2-1;case 1:return this.board.length-1;default:throw new Error("Invalid player "+e+".")}},houses:function(e){switch(this.players.indexOf(e)){case 0:return n.range(0,this.board.length/2-1).toArray();case 1:return n.range(this.board.length/2,this.board.length-1).toArray();default:throw new Error("Invalid player "+e+".")}},oppositeHouse:function(e,t){var r=this.houses(e),s=this.houses(this.opponent(e)),a=r.indexOf(t);return a<0?a:s.reverse()[a]},nextSquare:function(e,t){do{t=(t+1)%this.board.length}while(t===this.store(this.opponent(e)));return t},moves:function(){if(this.result())return null;var e=this.board,t={},r=this.activePlayer();return t[r]=this.houses(r).filter(function(t){return e[t]>0}),t[r].length>0?t:null},scores:function(){var e=this,t=this.board,r=this.players.map(function(r){return o(e.houses(r)).map(function(e){return t[e]}).sum()});if(r[0]>0&&r[1]>0)return null;var s={};return this.players.forEach(function(a,i){s[a]=t[e.store(a)]+e.countRemainingSeeds*r[i]}),s},result:function(){var e=this.scores(),t=this.players;return e&&this.zerosumResult(e[t[0]]-e[t[1]],t[0])},next:function(e,t,r){i(t,"Haps are not required (given ",t,")!");var s,a,n,o=this.activePlayer(),u=+e[o],h=this.board.slice(0),c=h[u];for(i(c<1,"Invalid move ",u," for game ",this),h[u]=0;c>0;c--)h[u=this.nextSquare(o,u)]++;(s=u==this.store(o))||(n=this.oppositeHouse(o,u))>=0&&1==h[u]&&h[n]>0&&(h[a=this.store(o)]++,h[u]=0,this.emptyCapture||(h[a]+=h[n],h[n]=0));var l=s?o:this.opponent();return r?(this.activatePlayers(l),this.board=h,this):new this.constructor(l,h)},resultBounds:function(){var e=o(this.board).sum();return[-e,+e]},"static __SERMAT__":{identifier:h.__package__+".Mancala",serializer:function(e){return[e.activePlayer(),e.board]}},identifier:function(){return this.activePlayer().charAt(0)+this.board.map(function(e){return("00"+e.toString(36)).substr(-2)}).join("")},printBoard:function(){var e=this,r=t.Text.lpad,s=this.players[0],a=this.houses(s).map(function(t){return r(""+e.board[t],2,"0")}).reverse(),i=r(""+this.board[this.store(s)],2,"0"),n=this.players[1],o=this.houses(n).map(function(t){return r(""+e.board[t],2,"0")}),u=r(""+this.board[this.store(n)],2,"0");return"   "+a.join(" | ")+"   \n"+i+" ".repeat(2*a.length+3*(a.length-1)+2)+u+"\n   "+o.join(" | ")+"   "}});return s.games.Mancala=c,h.__SERMAT__.include.push(c),r.include(h),c.heuristics={fromWeights:function(e){var t=o(e).map(Math.abs).sum();function r(r,s){var a,i=0;switch(r.players.indexOf(s)){case 0:a=1;break;case 1:a=-1;break;default:throw new Error("Invalid player "+s+".")}return o(r.board).map(function(t,r){return i+=t,t*e[r]}).sum()/t/i*a}return r.weights=e,r}},c.heuristics.DEFAULT=c.heuristics.fromWeights([1,1,1,1,1,1,5,-1,-1,-1,-1,-1,-1,-5]),h});
//# sourceMappingURL=ludorum-game-mancala.min.js.map